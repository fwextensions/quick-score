<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: QuickScore</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles/overrides.css">
</head>

<body>

<div id="main">
    <h1 class="page-title">Class: QuickScore</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>QuickScore<span class="signature">(items<span class="signature-attributes">opt</span>, options<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h2>
        
            <div class="class-description"><p>A class for scoring and sorting a list of items against a query string.  Each
item receives a floating point score between <code>0</code> and <code>1</code>.</p></div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    
    <h4 class="name" id="QuickScore"><span class="type-signature"></span>new QuickScore<span class="signature">(items<span class="signature-attributes">opt</span>, options<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>
    

    











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>items</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;(string|object)></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>The list of items to score.  If
the list is not a flat array of strings, a <code>keys</code> array must be supplied
via the second parameter.  QuickScore makes a shallow copy of the <code>items</code>
array, so changes to it won't have any affect, but changes to the objects
referenced by the array need to be passed to the instance by a call to
its <a href="QuickScore.html#setItems">setItems()</a> method.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;<a href="global.html#ItemKey">ItemKey</a>></span>
|

<span class="param-type"><a href="global.html#Options">Options</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>If the <code>items</code> parameter
is an array of flat strings, the <code>options</code> parameter can be left out.  If
it is a list of objects containing keys that should be scored, the
<code>options</code> parameter must either be an array of key names or an object
containing a <code>keys</code> property.</p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>keys</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;<a href="global.html#ItemKey">ItemKey</a>></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>In the simplest case, an array of
key names to score on the objects in the <code>items</code> array.</p>
<p>The key names can point to a nested key by passing either a dot-delimited
string or an array of sub-keys that specify the path to the value.  So a
key <code>name</code> of <code>&quot;foo.bar&quot;</code> would evaluate to <code>&quot;baz&quot;</code> given an object like
<code>{ foo: { bar: &quot;baz&quot; } }</code>.  Alternatively, that path could be passed as
an array, like <code>[&quot;foo&quot;, &quot;bar&quot;]</code>.  In either case, if this sub-key's match
produces the highest score for an item in the search results, its
<code>scoreKey</code> name will be <code>&quot;foo.bar&quot;</code>.</p>
<p>If your items have keys that contain periods, e.g., <code>&quot;first.name&quot;</code>, but
you don't want these names to be treated as paths to nested keys, simply
wrap the name in an array, like <code>{ keys: [&quot;ssn&quot;, [&quot;first.name&quot;], [&quot;last.name&quot;]] }</code>.</p>
<p>Instead of a string or string array, an item in <code>keys</code> can also be passed
as a <code>{name, scorer}</code> object, which lets you specify a different scoring
function for each key.  The scoring function should behave as described
next.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>sortKey</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    options.keys[0]
                
                </td>
            

            <td class="description last"><p>An optional key name
that will be used to sort items with identical scores.  Defaults to the
name of the first item in the <code>keys</code> parameter.  If <code>sortKey</code> points to
a nested key, use a dot-delimited string instead of an array to specify
the path.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>minimumScore</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    0
                
                </td>
            

            <td class="description last"><p>An optional value that
specifies the minimum score an item must have to appear in the results
returned from <a href="QuickScore.html#search">search()</a>.  Defaults to <code>0</code>,
so items that don't match the full <code>query</code> will not be returned.  This
value is ignored if the <code>query</code> is empty or undefined, in which case all
items are returned, sorted alphabetically and case-insensitively on the
<code>sortKey</code>, if any.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>transformString</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#TransformStringFunction">TransformStringFunction</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>An optional
function that takes a <code>string</code> parameter and returns a transformed
version of that string.  This function will be called on each of the
searchable keys in the <code>items</code> array as well as on the <code>query</code>
parameter to the <code>search()</code> method.  The default function calls
<code>toLocaleLowerCase()</code> on each string, for a case-insensitive search.  The
result of this function is cached for each searchable key on each item.</p>
<p>You can pass a function here to do other kinds of preprocessing, such as
removing diacritics from all the strings or converting Chinese characters
to pinyin.  For example, you could use the
<a href="https://www.npmjs.com/package/latinize"><code>latinize</code></a> npm package to
convert characters with diacritics to the base character so that your
users can type an unaccented character in the query while still matching
items that have accents or diacritics.  Pass in an <code>options</code> object like
this to use a custom <code>transformString()</code> function:
<code>{ transformString: s =&gt; latinize(s.toLocaleLowerCase()) }</code></p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>scorer</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#ScorerFunction">ScorerFunction</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>An optional function that takes
<code>string</code> and <code>query</code> parameters and returns a floating point number
between 0 and 1 that represents how well the <code>query</code> matches the
<code>string</code>.  It defaults to the <a href="global.html#quickScore">quickScore()</a> function
in this library.</p>
<p>If the function gets a third <code>matches</code> parameter, it should fill the
passed-in array with indexes corresponding to where the query
matches the string, as described in the <a href="QuickScore.html#search">search()</a>
method.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>config</code></td>
            

            <td class="type">
            
                
<span class="param-type">Config</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>An optional object that is passed to
the scorer function to further customize its behavior.  If the
<code>scorer</code> function has a <code>createConfig()</code> method on it, the <code>QuickScore</code>
instance will call that with the <code>config</code> value and store the result.
This can be used to extend the <code>config</code> parameter with default values.</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="QuickScore.js.html">QuickScore.js</a>, <a href="QuickScore.js.html#line8">line 8</a>
    </li></ul></dd>
    

    

    

    
</dl>




















    
    </div>

    

    

    
        <h3 class="subsection-title">Classes</h3>

        <dl>
            <dt><a href="QuickScore.html">QuickScore</a></dt>
            <dd></dd>
        </dl>
    

    

    

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="items"><span class="type-signature">(readonly) </span>items<span class="type-signature"> :Array.&lt;object></span></h4>




<div class="description">
    <p>The array of items to search, which
should only be modified via the <a href="QuickScore.html#setItems">setItems()</a>
method.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Array.&lt;object></span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="QuickScore.js.html">QuickScore.js</a>, <a href="QuickScore.js.html#line9">line 9</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="keys"><span class="type-signature">(readonly) </span>keys<span class="type-signature"> :Array.&lt;<a href="global.html#ItemKey">ItemKey</a>></span></h4>




<div class="description">
    <p>The keys to search on each item, which
should only be modified via the <a href="QuickScore.html#setKeys">setItems()</a>
method.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Array.&lt;<a href="global.html#ItemKey">ItemKey</a>></span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="QuickScore.js.html">QuickScore.js</a>, <a href="QuickScore.js.html#line17">line 17</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="search"><span class="type-signature"></span>search<span class="signature">(query)</span><span class="type-signature"> &rarr; {Array.&lt;(<a href="global.html#ScoredString">ScoredString</a>|<a href="global.html#ScoredObject">ScoredObject</a>)>}</span></h4>
    

    



<div class="description">
    <p>Scores the instance's items against the <code>query</code> and sorts them from
highest to lowest.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The string to score each item against.  The
instance's <code>transformString()</code> function is called on this string before
it's matched against each item.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="QuickScore.js.html">QuickScore.js</a>, <a href="QuickScore.js.html#line188">line 188</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>When the instance's <code>items</code>
are flat strings, an array of <a href="global.html#ScoredString"><code>ScoredString</code></a>
objects containing the following properties is returned:</p>
<ul>
<li><code>item</code>: the string that was scored</li>
<li><code>score</code>: the floating point score of the string for the current query</li>
<li><code>matches</code>: an array of arrays that specify the character ranges
where the query matched the string</li>
</ul>
<p>When the <code>items</code> are objects, an array of <a href="global.html#ScoredObject"><code>ScoredObject</code></a>
results is returned:</p>
<ul>
<li><code>item</code>: the object that was scored</li>
<li><code>score</code>: the highest score from among the individual key scores</li>
<li><code>scoreKey</code>: the name of the key with the highest score, which will be
an empty string if they're all zero</li>
<li><code>scoreValue</code>: the value of the key with the highest score, which makes
it easier to access if it's a nested string</li>
<li><code>scores</code>: a hash of the individual scores for each key</li>
<li><code>matches</code>: a hash of arrays that specify the character ranges of the
query match for each key</li>
</ul>
<p>The results array is sorted high to low on each item's score.  Items with
identical scores are sorted alphabetically and case-insensitively on the
<code>sortKey</code> option.  Items with scores that are &lt;= the <code>minimumScore</code> option
(defaults to <code>0</code>) are not returned, unless the <code>query</code> is falsy, in which
case all of the items are returned, sorted alphabetically.</p>
<p>The start and end indices in each <a href="global.html#RangeTuple"><code>RangeTuple</code></a> in the
<code>matches</code> array can be used as parameters to the <code>substring()</code> method to
extract the characters from each string that match the query.  This can
then be used to format the matching characters with a different color or
style.</p>
<p>Each <code>ScoredObject</code> item also has a <code>_</code> property, which caches transformed
versions of the item's strings, and might contain additional internal
metadata in the future.  It can be ignored.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;(<a href="global.html#ScoredString">ScoredString</a>|<a href="global.html#ScoredObject">ScoredObject</a>)></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="setItems"><span class="type-signature"></span>setItems<span class="signature">(items)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Sets the <code>items</code> array and caches a transformed copy of all the item
strings specified by the <code>keys</code> parameter to the constructor, using the
<code>transformString</code> option (which defaults to <code>toLocaleLowerCase()</code>).</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>items</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;(string|object)></span>


            
            </td>

            

            

            <td class="description last"><p>List of items to score.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="QuickScore.js.html">QuickScore.js</a>, <a href="QuickScore.js.html#line344">line 344</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="setKeys"><span class="type-signature"></span>setKeys<span class="signature">(keys, sortKey<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Sets the <code>keys</code> configuration.  <code>setItems()</code> must be called after
changing the keys so that the items' transformed strings get cached.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>keys</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;<a href="global.html#ItemKey">ItemKey</a>></span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>List of keys to score, as either strings
or <code>{name, scorer}</code> objects.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>sortKey</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    keys[0]
                
                </td>
            

            <td class="description last"><p>Name of key on which to sort
identically scored items.  Defaults to the first <code>keys</code> item.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="QuickScore.js.html">QuickScore.js</a>, <a href="QuickScore.js.html#line293">line 293</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="QuickScore.html">QuickScore</a></li><li><a href="Range.html">Range</a></li></ul><h3>Global</h3><ul><li><a href="global.html#quickScore">quickScore</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.10</a> on Thu May 19 2022 19:33:39 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>